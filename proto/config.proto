syntax = "proto3";
package platform;
option go_package = "proto/pb";

message Config {
  string id = 1;
  string name = 2;
  string manifest = 3;
  Project desiredState = 4;
  Project currentState = 5;
  bytes msChecksum = 6;
  bytes dsChecksum = 7;
  bytes csChecksum = 8;
  int32 builderTTL = 9;
  int32 schedulerTTL = 10;
  string errorMessage = 11;
}

message Project {
  string name = 1;
  repeated Provider providers = 2;
  repeated NodePool nodePools = 3;
  LoadBalancer loadBalancer = 4;
  Kubernetes kubernetes = 5;
}

message Provider {
  string name = 1;
  string crendtials = 2;
}

message NodePool {
  repeated DynamicNode dynamic = 1;
  repeated StaticNode static = 2;
}

message LoadBalancer {
  repeated Role roles = 1;
  repeated LoadBalancerCluster clusters = 2;
}

message Kubernetes {
  repeated Cluster cluster = 1;
}

message DynamicNode {
  string name = 1;
  string provider = 2;
  int64 count = 3;
  string serverType = 4;
  string imaeg = 5;
  int64 diskSize = 6;
}

message StaticNode {
  string name = 1;
  repeated Node nodes = 2;
}

message Node {
  string publicIP = 1;
  string privateSSHKey = 2;  
}

message Cluster {
  string name = 1;
  string version = 2;
  string network = 3;
  repeated Pool pools = 4;
}

message Pool {
  repeated string control = 1;
  repeated string compute = 2;
}

message Role {
  string name = 1;
}

message LoadBalancerCluster {
  string name = 1;
  string role = 2;
  repeated DNS dns = 3;
  Target target = 4;
  repeated string pools = 5;
}

message DNS {
  string hostname = 1;
  repeated string provider = 2;
}

message Target {
  string name = 1;
  string type = 2;
}