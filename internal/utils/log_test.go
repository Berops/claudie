package utils

import "testing"

// TestSanitiseURI tests the SanitiseURI function.
func TestSanitiseURI(t *testing.T) {
	testCases := []struct {
		desc string
		in   string
		out  string
	}{
		{
			desc: "Strip password from log message",
			in:   "mongodb://USERNAME:secretPassword@domain.tld/",
			out:  "mongodb://USERNAME:*****@domain.tld/",
		},
		{
			desc: "Strip password from short PQDN",
			in:   "https://uname:secret@pqdn",
			out:  "https://uname:*****@pqdn",
		},
		{
			desc: "Don't sanitise URI without password",
			in:   "mailto://nobody@domain.tld",
			out:  "mailto://nobody@domain.tld",
		},
		{
			desc: "Don't sanitise hostname",
			in:   "http://somehostname:port",
			out:  "http://somehostname:port",
		},
	}

	for _, tC := range testCases {
		t.Run(tC.desc, func(t *testing.T) {
			want := tC.out

			if got := SanitiseURI(tC.in); got != want {
				t.Errorf("Unexpected output for %q: expected %q, actual %q",
					tC.desc, want, got)
			}
		})
	}
}

// TestSanitiseKubeconfig tests the SanitiseKubeconfig function.
func TestSanitiseKubeconfig(t *testing.T) {
	testCases := []struct {
		desc string
		in   string
		out  string
	}{
		{
			desc: "Sanitise real-ish kubeconfig",
			// Note: the secrets were autogenerated for the purpose of testing,
			// no real secrets are being exposed.
			in: `--more 'args' --leave-this-alone --kubeconfig 'apiVersion: v1
clusters:
- cluster:
    # dd if=/dev/urandom count=1 status=progress bs=1k | openssl aes-256-cbc | base64 - -w0
    certificate-authority-data: U2FsdGVkX1/AStt2mx+/Xof5+3uYwFE8yQJEE0QJd3Jyxzv9NbgYOyuLi2ZXfpcHrSb05fWLo45bdE0KOJ7ORI5DfGrfaaN6WUKH8IGq5a/bYL+exJbx54SmkpL14gzk1rXHEClG8Ls2uIGSblxDVex7jFr7h0LQ9yJE66vULXoW+k2W3gNLqVZqMLI2lpN6esIwNPHvuU0NTjesfYrMl6nAXg9fbcEsGaBGhSelEzCr8zNGYVUOtwgXQ19uDmcUTxzjzH9t5N0pyyboDzpyzEPKBws+ad6W/cPxpA0alJH5Xt20yzO9TxcVOdOmi5QAoTH3WuFKjMUjfTHIz4prmu3EyeUaMra58SIUP1s9+tt8tzZU9gu3d6hGczu6Fbk93+7jw2s3+zfiBdEtYNEygXfSQA+ZZe+/B+KWzl9ayj/YOCVOFQK/mXuys+HMlXtTLJzuNTZMCYOT3YHy8dRbRO/RC4s8BezFWjzPqD8eDTHJZqTkVkuwTp2RsOZ3Awgqqf4EtsK5a9jeqobjCEHG0yvHvRMgzD2h9K32Yph8NqPAwiYLWxJUs6v/Dqji5BNkSMuFghow/1w47QN/BxMQv51dPTs8+35pyGa4f4SfQXiQly8NRsctnrQh6gGgKKbGPRyVhThWLRV0oC+cl+6twKMGQWDqBCfB3wyZVlhhWqHKkwxkT2V4gzbo5zEdBfKaggO4MyN5PiYEtdwHK9X8PUxd1ot7RMZzckJfW5QErfdkhcl3f5aSUKk6WYOpwaoFzMgM8vfB1l1GNIjQcG28+Zb1j7FhFNZy4cN8FS4O6O7U3XowBxu7xcQFziV+MRrlw0qpQ83QsgJB15tnwhGxpaosWU7CcanXFZLsRE2JxHboAnBXth1wn8PQ+MKebmm9o3CLTPbjGzNuAksF0aDnOqHNY/SkPi6VQGEnGmfKN3gviAKHngEXGLPQYiCWZ+k2Pjur+dTIiP9MFyEOQcLArHCwOOhC5W1kfSi/+9s09Jo0hTRgospvBYzdv96v+XhpUWNwqamOzsS7WZXc8iTjRBeJke0HWBTEjehR6OfX1DmgGvuj41CqoNk8NMSq1Bw9fYrJyXRAaNIzKkDPVl9yVINH5Wtr4x0av+iCuK7pAkPJ5wCwvx4IqlMkg6GuEnFBOt5JVdxqx+JStCBfCOpXpDBa2F5cyQCpsZRyXVyujp5yyce+jpJk5CvqYa4satkCcO5OWDQoMvG21imn7mXvoaTF395KQjW4EByDDVrbJ6lRSqIRZKRqiuFK7bhW80fD2G8/KDd8MRj1cymd0iHCJgzyUnqnmGdn7GoVloFD6I1nFhH6WOAzsZvLuzQi9yrQNVKTjjVuiHBelyV2hcDJj3NAbkBGKb1EU3evNO3S2fnXEDQcMDu8gTxBndqG6UAh==
    server: https://0.0.0.0
  name: gke_claudie-5ce884fcdec13e18a693706011eea867880f93e214c1b1d217c9fc1d6ad60561ca04a61d894fb9f8a64b2a0d68095b50b856cb54f493f3efeb71803ebda7340b
- cluster:
    # dd if=/dev/urandom count=1 status=progress bs=1k | openssl aes-256-cbc | base64 - -w0
    certificate-authority-data: U2FsdGVkX197ufRbEazzOF5r3wLFmuoMEfjHxO27j1mJujW/aSZlFuj9fade1YUZCy2D8gnHWq4e4CQJcHJw/soQdN4nzqW384JTogZ0MCOh8NasuA+97EX0e10X2Z0k3A2vJn/7lMXoYmR73duVRZc15w4d4x8XzzXD4Gpk2t7BWfDviremQplDAQhgxGbiSHW4jfRFb3kfDqHpjjCXKzz+Qwe6L9oEm/l0QnuOUo120q+7HaFnuwJB8wyuz+YHWbDuwWMZlwjHD5fmv+sAjQgq5Li/yopkxvYxtwG/11lI1x4QilW9RBcTDwZzaaY5OXo9D8B0Cdq3MwsQCYyRX1Mlrj72w9HgC4RHO7tZynvRTPQy8Rcdc5s73Qq5bjktWHBSg48my9ja4P94YJOmgDuhKQ1yuQTf/Hyr1X+33v6f+ckkFchZeDiv50lajsZbqs02qb2g/HE/T3yJr9IHsWWjsDTRzCze5ntbfaPhfMmLkOZs9TWCtpUbfHXLNrcvIFEX7vJGsIRGjJDzLMBKN5LDm1hGcQwouEGMkwVnzm6MhQgjsgCOBuBGN6Zte30gP+VoqGsrbnJIT9AobupBq818mtg4DyZ9ieQEj1JpBzqrm0v/cnGLx6SS9eziirSjRcfjLX8XRx6x9waqu0Y8qabR1cfvm4acEQI+X6BhN6q/1/9cesXfJONJaducf94h1Ftcdua+UoPObmDJoxeyREPdJbPJSdDho2lReDUEgAV55ONSj6Uz4zihyfDRQo0rDRBmkL/y40NXp4Xj3ToFk09ESHaVnETMex388G5+Cv2qp51rAXht3bdo2wbyM8ZLsGj7xwGCdeXeKeD5TVeSUzdv0QzXqgkzBmPQq4dLzipKrcmU1QFUBlF5CHQTW+sGQAKdA9+uP0hk92GvhL/xR2XwOFqy5mVNB7kbM/YVV2s1V4KntFa7ECD1gdHD6OREdXblFA9ds5uA+LvlqXKhKIkVfrw5LPHrsZSu4iwOV0oOndU9ioGmsDMF2IGhir7c7kw0EuITq0mB6TIHyGtSTU6qa3bUrn4md521OmKVW7tre062oS5YHUo2QT15DsiTC360ACwmawZOATYHeZCGYwN+TuAITaZn3ah9VEDTewFjb5vbW9C8mUNSyH4NYksSXzVNOaO4kJ0IhsiIsb3GViRz/lhuIFToT6hjp10NFYaGYRogMOLjU7qutFEpaTSkHFJaJw/Ir0bXQOvj5jXDBscsUCTvBUmOTOwKF0jXKXMF85gkGGYqxU8wckvwdyVo7vC5rrk14tAzoD9Kc4lvjGcttBKGw2MNn7hPuAme7S8vifygrQiCfjly429xZNBpsrs/UAq0ErhYiE98FrLkUOhJ3UZptq9B6o87sEis5OLVLdMGAH5X1HFwZgDtGXlq==
    server: https://0.0.0.0
  name: gke_claudie-614e8967b856fd6d5fb9a9b391f89396b6afe6db6add7e818f176c4be7e339946d94496b139de4287cc5c3ac5c1a9e0afe59843f5f74781aed05fad14e9dd713
- cluster:
    # dd if=/dev/urandom count=1 status=progress bs=1k | openssl aes-256-cbc -iter 10000 | base64 - -w0
    certificate-authority-data: U2FsdGVkX1/Aj/N9ix65/7s6WuerATuky1TIwm+PjeXYnDuxv5MSQxW8RZ2K69IGt8KWy4dcMvO35/FBhaLQ6o78NgtZoJ7cAEs8yptNnio1CKAw7Ld8wnQfzLg5wtfu+VuuFYGv6bsMd9SWTS++xkzamh+iskAQ7Rwz51XLdCT/7/W3MJ8o8PCoEymNVYR1R7zI7JuiUBrerSDVmb1otf+y2vaohP7ciAwgyszSth5ja55PXzJLOj7Rbaodipl0s9VIFD1YkO2AFRHISCGEsWOLNR95xfCAioitOnmHJrbJLfDfP0EHeVe8xF0KWJdIPWphcIV4RKawyJqhUD4D/VvzlgmMpP7Q3TYJXlsCeJUjCaBxHfyCKqGBxTaW5JWphvAfomOpjFgo5Smz+AzKl2dLD1bYimqW/03Q09i1f79AbUuuQmfkUbdc7ODjDFlFOgHH42+bAgr28Uw9thsONQFAKyI8OEz2rMPmvYZBfXNns0x9IthfLgUy9tXnwzWE6djdeaUmTJOJjATfldLcA7F6Bs04smZEYOJcz/n84N5AYy5drX0d5Ws+A7IHh4/H1znnpFJNWfkIwXQKgExKbk4QWB3j/9jTyUVKeQyTOCsRoccgmAgIkumtZ+r81Dm95no9R+f3V0DIBUsHrB2npZ9R0YU+c+gZUVr4W38m2MIyb2pXUcKAUf4AC17YH6VHZg+p1vNrpt52IEJpqtndR6a81Ae2Z+laape33PoSjvgH60XK3vhGbyPkjac8yUGTl40KBxgbOc8s5yhHBTcxAVWPaVEHpFLGtmIdaJXsBxdCpvBTPWmQpeaO1DXbzQlB/HoheK47gxKcDGgY3jJNhfbHMWJBXT73UBavWRkwen1v1CcqgIDuKY1nkOZX9vwa98udTy0AVnpCyvCkTBsMmYwLHWp1fnucy/M5AnVLZiSY0Vw7HemFAXbVTHcdyZBGX+YvfcMmPs+ExHAfsXFoYvFRZTM+bF+5wMoOMsYyUAJrwWuquONt+ZpsWZikWGlgbp+eQoJiVQvn5kH++FSBjCPRnDe+fzZyaJoVjJAlt2Fqkmdxu6uXTnk2YLLRmg309iSQAsrW8SbHiHexbZufV280XE9bDzzpEQJ1ph8gY+s73wNZ0KzsVGjXhxKaI2hIV1X8r/XRKy7Mtj89CmqV+nY2694fw+rTJRfDxAA/57Wx2v2Y6US9VG0LukZEn2DQnOaeuPCIVmokpyjTFO5K0hY7PSVB88sWx2aghNQlIHiDlAcx/voYIJylHGOzEx4XoaGN0HYAgrO8GDKMQuwiKytkLGbPBVyMQuV1oeROUWzKkBy/ilacA2azkbX+Weae1rxYM6RJeRBf25cU6xtJszXoWtcilD+x+R8X+ezM+dSl5Ft+5hn7nLcbVY41je0J==
    server: https://0.0.0.0
  name: kind-kind
contexts:
- context:
    cluster: gke_claudie-5ce884fcdec13e18a693706011eea867880f93e214c1b1d217c9fc1d6ad60561ca04a61d894fb9f8a64b2a0d68095b50b856cb54f493f3efeb71803ebda7340b
    user: gke_claudie-5ce884fcdec13e18a693706011eea867880f93e214c1b1d217c9fc1d6ad60561ca04a61d894fb9f8a64b2a0d68095b50b856cb54f493f3efeb71803ebda7340b
  name: gke_claudie-5ce884fcdec13e18a693706011eea867880f93e214c1b1d217c9fc1d6ad60561ca04a61d894fb9f8a64b2a0d68095b50b856cb54f493f3efeb71803ebda7340b
- context:
    cluster: gke_claudie-614e8967b856fd6d5fb9a9b391f89396b6afe6db6add7e818f176c4be7e339946d94496b139de4287cc5c3ac5c1a9e0afe59843f5f74781aed05fad14e9dd713
    user: gke_claudie-614e8967b856fd6d5fb9a9b391f89396b6afe6db6add7e818f176c4be7e339946d94496b139de4287cc5c3ac5c1a9e0afe59843f5f74781aed05fad14e9dd713
  name: gke_claudie-614e8967b856fd6d5fb9a9b391f89396b6afe6db6add7e818f176c4be7e339946d94496b139de4287cc5c3ac5c1a9e0afe59843f5f74781aed05fad14e9dd713
- context:
    cluster: kind-kind
    user: kind-kind
  name: kind-kind
current-context: gke_claudie-614e8967b856fd6d5fb9a9b391f89396b6afe6db6add7e818f176c4be7e339946d94496b139de4287cc5c3ac5c1a9e0afe59843f5f74781aed05fad14e9dd713
kind: Config
preferences: {}
users:
- name: gke_claudie-5ce884fcdec13e18a693706011eea867880f93e214c1b1d217c9fc1d6ad60561ca04a61d894fb9f8a64b2a0d68095b50b856cb54f493f3efeb71803ebda7340b
  user:
    exec:
      apiVersion: client.authentication.k8s.io/v1beta1
      command: gke-gcloud-auth-plugin
      installHint: Install gke-gcloud-auth-plugin for use with kubectl by following
        https://cloud.google.com/blog/products/containers-kubernetes/kubectl-auth-changes-in-gke
      provideClusterInfo: true
- name: gke_claudie-614e8967b856fd6d5fb9a9b391f89396b6afe6db6add7e818f176c4be7e339946d94496b139de4287cc5c3ac5c1a9e0afe59843f5f74781aed05fad14e9dd713
  user:
    exec:
      apiVersion: client.authentication.k8s.io/v1beta1
      command: gke-gcloud-auth-plugin
      installHint: Install gke-gcloud-auth-plugin for use with kubectl by following
        https://cloud.google.com/blog/products/containers-kubernetes/kubectl-auth-changes-in-gke
      provideClusterInfo: true
- name: kind-kind
  user:
    # dd if=/dev/urandom count=1 status=progress bs=1k | openssl aes-256-cbc -iter 10000 | base64 - -w0
    client-certificate-data: U2FsdGVkX18wmEcxtRHAQFaBXXN8Y/oSoIcggmL2W/f+DV2IYRQGtBP9RtR+RogkddC9kBAjy0ZKoVl9e32yaoYlAECX7kHfzYGZcNOIapQeegiWwPWk17BGASbEI8M8is818InCXz4fd1xJsyDbF+VkkURMTrctnPwHkSaOaKiHWl2UmPyizNvnsf3xOJfCfPluS7hCU51qd0md/S/H5ylDdPOfFHsXq/TBoUnh2mtlED1CBAey0rWUkLGOx0AuPzh5IWp+PphvFjlGtdVeK2PVIVZ4YSh0Bxcez7owFUkWRom+RZJMBRjX8XNPMmRBu7bwZeFthUUGH8sYvxruanRzh+SNrIviB5nlquh7CUAWe3JRL5ys2uDklHZuGoyDI1T929KtcuWrq2ENzLC/uji2R+DOI6FYcluO3H+mcjmHeUldAZeA4DAPkgp9Hq85Cm5oqprjF3iP8eS0PUNXJNT/MJYHYpiAJ6MiBitoMX1ZCyrNJ/TmcqIsKFDdl3Y9ttcLxd778WuTCcJ7EVzE0Io6C7IlJNDPkZ9+UoDOfmRxMw6eMZt2yQMPPK/YrYBLUGhg7ncGUDBlPZQ0A9LPG9NZFDOeJpsUP6dgDBGOEnrRs9NwRz3A7E6H+oUkvZR3LDlXc+4oooTljceHA4/n7sKNqs2pj6Ez3gcW73dKPKMUzdiftJGS/jMyOy945kI5RH68Jh1f4CSzTpbnFkwstXMSiFbsYTz5Gqjk9YPL/xadwpTfBCjrJQfadxvz0NbwIyTuRA79UjWuwZexIe2lU1tweqzt49pVhmLrBkJdptPfj91NwrcyEOe/Kw1FKAxrCL+9PfQ95uu+WXalrbJWEGNxN5KAT91ZFuiOBd6/L807zwlQCGgOLU3sr6GBh22ghXqItv80tT7wi6OtnPhky7Wv0+NydNPfMRYqWepadsw4MZbqODt09Y1Ss+gQVIb74awlwnY2jQKPNoH6mD7vYUWnCe+0y1SPW8K+f9XnZoceQiux8GtJr5/VlAvev9oITw6swj1RihXoZFTq5J+pihqAluYl+f5YdrBMCZYy6LPUOh3CAxe4xCLvnL7NjcPlHPGblvipmeKC3dLEoAoOBw9+HKiFO372fWuMgRj7KTrBIZozhWDSnjSIBUw+1Sojlf2VPzLkPgW/ULJDJT7cQt5Rlkhoz3MeqEtE2BfYnxttRQtp5hpgX4OCoX1wpQGW4bPi3F5+07LI1HhEJafFxIA5IBiizWopu5aUxRMtanEEl10A9o+yxiNtUGZBXc//SaXBNut17F6ajI9km/9Aw44WEDroXDGp+8QLrZj+HyK4c8C5BuZQeAZr9PqTEgF57MCDShNQ+It96KOEwndEkDOd84r5+cwCja4exPIqNk8HxuH/oWpc10O2sdnInWtK==
    # dd if=/dev/urandom count=1 status=progress bs=2k | openssl aes-256-cbc -iter 10000 | base64 - -w0
    client-key-data: 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
' --argzz`,
			out: "--more 'args' --leave-this-alone --kubeconfig '*****' --argzz",
		},
		{
			desc: "Sanitise bogus kubeconfig passed in the correct form",
			in:   "--more-argz --kubeconfig 'not really a kubeconfig'",
			out:  "--more-argz --kubeconfig '*****'",
		},
		{
			desc: "Don't sanitise when no kubeconfig passed",
			in:   "--kubeconfig --argzz",
			out:  "--kubeconfig --argzz",
		},
		{
			desc: "Don't sanitise when no kubeconfig passed 2",
			in:   "randomcmd --kubeconfig --forgot-the-kubeconfig",
			out:  "randomcmd --kubeconfig --forgot-the-kubeconfig",
		},
		{
			desc: "Don't sanitise random text",
			in:   "random text",
			out:  "random text",
		},
	}

	for _, tC := range testCases {
		t.Run(tC.desc, func(t *testing.T) {
			want := tC.out

			if got := SanitiseKubeconfig(tC.in); got != want {
				t.Errorf("Unexpected output for %q: expected %q, actual %q",
					tC.desc, want, got)
			}
		})
	}
}
